# آزمایش پیاده‌سازی شما

این سند مجموعه‌ای از تست‌ها را ارائه می‌دهد که می‌توانید از آنها برای تأیید صحت عملکرد پیاده‌سازی خود در هر نقطه عطف استفاده کنید. اجرای این تست‌ها به شما کمک می‌کند تا باگ‌ها را زودتر شناسایی کرده و مطمئن شوید که در مسیر درستی قرار دارید.

## نقطه عطف 1: کلیدها و UTXOها

### تست: تولید جفت کلید

-   **دستور:** `GiveKeyPair`
-   **نتیجه مورد انتظار:** دستور باید دو رشته هگزادسیمال را چاپ کند که نشان‌دهنده کلید خصوصی و کلید عمومی هستند.
    ```
    privateKey: 2a84154c1a6b3e8d... publicKey: 02f8b4b4d...
    ```

## نقطه عطف 2: تراکنش‌ها و امضاها

### تست: پذیرش تراکنش معتبر

1.  یک تراکنش معتبر با فرمت JSON ایجاد کنید که به یک UTXO موجود اشاره کرده و به درستی امضا شده باشد.
2.  **دستور:** `AddTransactionToMempool '{'''inputs''': [{'''prevTxId''': '''abc...''', '''prevOutIndex''': 0, '''publicKey''': '''02...''', '''signature''': '''30...'''}], '''outputs''': [{'''value''': 5000, '''publicKey''': '''02...'''}, {'''value''': 2000, '''publicKey''': '''03...'''}]}'`
3.  **نتیجه مورد انتظار:** دستور باید وضعیت ممپول را با فرمت JSON چاپ کند، با تراکنش‌هایی که بر اساس نرخ کارمزد اجدادی به ترتیب نزولی مرتب شده‌اند.
    ```json
    {
      "count": 1,
      "txs": [
        { "txid": "a1..", "ancestorFee": 900, "ancestorSize": 450, "ancestorFeeRate": 2.0 }
      ]
    }
    ```

### تست: تراکنش دستکاری شده

1.  یک تراکنش معتبر را برداشته و یکی از مقادیر خروجی آن را تغییر دهید.
2.  **دستور:** `AddTransactionToMempool '{'''inputs''': [{'''prevTxId''': '''abc...''', '''prevOutIndex''': 0, '''publicKey''': '''02...''', '''signature''': '''30...'''}], '''outputs''': [{'''value''': 5001, '''publicKey''': '''02...'''}, {'''value''': 2000, '''publicKey''': '''03...'''}]}'`
3.  **نتیجه مورد انتظار:** تراکنش باید به دلیل عدم تأیید امضا رد شود. برنامه شما باید یک پیام خطا نمایش دهد.
    ```
    Error: signature verification failed
    ```

## نقطه عطف 3: ممپول

### تست: حذف تراکنش

-   **دستور:** `EvictMempool 1`
-   **نتیجه مورد انتظار:** دستور باید تراکنش با کمترین نرخ کارمزد فرزند (و تمام فرزندان آن) را از ممپول حذف کند. خروجی باید وضعیت ممپول باشد که بر اساس نرخ کارمزد فرزند به ترتیب صعودی مرتب شده است.
    ```json
    {
      "count": 0,
      "txs": []
    }
    ```

## نقطه عطف 4 و 5: مونتاژ و استخراج بلاک

### تست: استخراج یک بلاک

1.  **دستورات:**
    ```bash
    SetDifficulty 12
    MineBlock
    ```
2.  **نتیجه مورد انتظار:** دستور باید یک بلاک معتبر با فرمت JSON را خروجی دهد. هش بلاک باید با سختی مشخص شده مطابقت داشته باشد، اندازه کل باید کمتر یا مساوی 2000 بایت باشد، و تراکنش کوین‌بیس باید به درستی یارانه بلاک و کارمزدهای تراکنش را جمع‌آوری کند.
    ```json
    {
      "blockHash": "0000...",
      "header": {
        "prevBlockHash": "000...", // برای بلاک جنسیس، این یک رشته 64 صفر است.
        "merkleRoot": "def...",
        "difficulty": { "leadingZeroBits": 12 },
        "nonce": 12345
      },
      "sizeBytes": 1234,
      "transactions": [
        { ... تراکنش کوین‌بیس ... },
        { ... تراکنش 1 ... }
      ]
    }
    ```

## نقطه عطف 6: اثبات‌های مرکل

### تست: تأیید اثبات مرکل

1.  **دستورات:**
    ```bash
    GetMerkleProof <txid> <block-height>
    VerifyTxInclusion <txid> <block-height> '{'''siblings''': ["..."], '''positions''': ["L"]}'
    ```
2.  **نتیجه مورد انتظار:** دستور `VerifyTxInclusion` باید برای تراکنشی که در بلاک گنجانده شده است، `true` و برای تراکنشی که گنجانده نشده است، `false` را برگرداند.
    ```
    true
    ```

---
[← بازگشت: نقاط عطف و چک‌لیست‌ها](milestones.md) · [بعدی: شروع به کار →](getting-started.md)