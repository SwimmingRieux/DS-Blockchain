# نقاط عطف تکلیف

این سند تکلیف را به مجموعه‌ای از نقاط عطف قابل مدیریت تقسیم می‌کند. هر نقطه عطف دارای مجموعه‌ای واضح از وظایف و معیارهای پذیرش است تا به شما کمک کند پیشرفت خود را پیگیری کرده و صحت پیاده‌سازی خود را تأیید کنید.

## نقطه عطف 1: بلوک‌های سازنده

در این نقطه عطف، شما ساختارهای داده بنیادی و اصول رمزنگاری بلاکچین خود را پیاده‌سازی خواهید کرد.

### وظایف

-   **تولید جفت کلید:** تابعی را برای تولید یک جفت کلید عمومی/خصوصی جدید پیاده‌سازی کنید. کلیدها باید به صورت رشته‌های هگزادسیمال نمایش داده شوند.
-   **سریال‌سازی:** مجموعه‌ای قطعی از قوانین را برای سریال‌سازی ساختارهای داده خود (بلوک‌ها، تراکنش‌ها و غیره) تعریف و پیاده‌سازی کنید.
-   **شناسه تراکنش (txid):** تابعی را برای محاسبه `txid` یک تراکنش با هش کردن داده‌های سریال‌سازی شده آن پیاده‌سازی کنید.
-   **مجموعه UTXO:** مجموعه UTXO را به عنوان یک نگاشت پیاده‌سازی کنید که در آن کلید `txid:index` و مقدار `{ value, publicKey }` است.

### معیارهای پذیرش

-   دستور `GiveKeyPair` یک جفت کلید جدید را به درستی چاپ می‌کند.
-   سریال‌سازی یک تراکنش یکسان دو بار، توالی بایت دقیقاً یکسانی را تولید می‌کند.
-   افزودن خروجی‌ها از یک تراکنش جدید، ورودی‌های جدیدی را در مجموعه UTXO به درستی ایجاد می‌کند.

## نقطه عطف 2: ایجاد و اعتبارسنجی تراکنش‌ها

اکنون که بلوک‌های سازنده اساسی را دارید، منطق ایجاد و اعتبارسنجی تراکنش‌ها را پیاده‌سازی خواهید کرد.

### وظایف

-   **ساختار تراکنش:** ساختار یک تراکنش را تعریف کنید، شامل ورودی‌ها (`prevTxId`, `prevOutIndex`, `publicKey`, `signature`) و خروجی‌ها (`value`, `publicKey`).
-   **پیش‌تصویر تراکنش:** منطق ایجاد پیش‌تصویر تراکنش برای امضا را پیاده‌سازی کنید.
-   **تأیید امضا:** تابعی را برای تأیید امضای دیجیتال یک تراکنش پیاده‌سازی کنید. این شامل بررسی وجود UTXOهای ارجاع شده، مطابقت کلیدهای عمومی و معتبر بودن امضا برای پیش‌تصویر است.
-   **محاسبه کارمزد:** منطق محاسبه کارمزد تراکنش را به صورت `sum(inputs) - sum(outputs)` پیاده‌سازی کنید و اطمینان حاصل کنید که غیر منفی است.

### معیارهای پذیرش

-   یک تراکنش معتبر توسط گره شما پذیرفته می‌شود.
-   یک تراکنش با خروجی دستکاری شده (به عنوان مثال، مقدار یا گیرنده تغییر یافته) در تأیید امضا شکست می‌خورد.
-   یک تراکنش با کارمزد منفی رد می‌شود.

## نقطه عطف 3: ممپول

در این نقطه عطف، شما ممپول را پیاده‌سازی خواهید کرد که منطقه انتظار برای تراکنش‌های تأیید نشده است.

### وظایف

-   **ساختار DAG:** ممپول را به عنوان یک گراف جهت‌دار غیرمدور (DAG) برای ردیابی وابستگی‌های بین تراکنش‌ها پیاده‌سازی کنید.
-   **امتیازدهی تراکنش:** مکانیزم‌های امتیازدهی نرخ کارمزد اجدادی و فرزندی را پیاده‌سازی کنید. از دو درخت جستجوی دودویی متعادل برای حفظ ترتیب تراکنش‌ها استفاده کنید.
-   **`AddTransactionToMempool`:** دستور `AddTransactionToMempool` را پیاده‌سازی کنید که باید ممپول را به ترتیب نزولی بر اساس نرخ کارمزد اجدادی چاپ کند.
-   **`EvictMempool`:** دستور `EvictMempool` را پیاده‌سازی کنید که باید `x` تراکنش با کمترین ارزش (بر اساس نرخ کارمزد فرزندی) و فرزندان آنها را حذف کند و سپس ممپول را به ترتیب صعودی بر اساس نرخ کارمزد فرزندی چاپ کند.

### معیارهای پذیرش

-   تراکنش‌های دارای وابستگی به درستی در ممپول مرتب می‌شوند.
-   حذف یک تراکنش، تمام فرزندان آن را نیز حذف می‌کند.

## نقطه عطف 4: مونتاژ یک بلوک

اکنون زمان آن است که نقش یک ماینر را بازی کنید و یک بلوک جدید را از تراکنش‌های موجود در ممپول مونتاژ کنید.

### وظایف

-   **انتخاب حریصانه:** یک الگوریتم حریصانه را برای انتخاب تراکنش‌ها از ممپول بر اساس نرخ کارمزد اجدادی آنها پیاده‌سازی کنید و اطمینان حاصل کنید که اندازه کل بلوک از حد 2000 بایت تجاوز نمی‌کند.
-   **مدیریت وابستگی:** اطمینان حاصل کنید که اگر یک تراکنش در یک بلوک گنجانده شود، تمام اجداد تأیید نشده آن نیز گنجانده می‌شوند.
-   **مرتب‌سازی توپولوژیکی:** تراکنش‌های انتخاب شده را قبل از گنجاندن آنها در بلوک، به صورت توپولوژیکی مرتب کنید.
-   **تراکنش کوین‌بیس:** تراکنش کوین‌بیس را برای جمع‌آوری پاداش بلوک (یارانه + کارمزدها) ایجاد کنید.

### معیارهای پذیرش

-   اندازه کل بلوک مونتاژ شده (شامل هدر) در حد 2000 بایت است.
-   تراکنش‌های موجود در بلوک به ترتیب توپولوژیکی معتبر (والدین قبل از فرزندان) هستند.

## نقطه عطف 5: استخراج بلوک

در این نقطه عطف، شما فرآیند استخراج اثبات کار را پیاده‌سازی خواهید کرد.

### وظایف

-   **ریشه مرکل:** ریشه مرکل تراکنش‌ها را در بلوک محاسبه کنید.
-   **اثبات کار:** حلقه استخراج را پیاده‌سازی کنید که به دنبال یک `nonce` می‌گردد که منجر به هش بلوک با تعداد مورد نیاز بیت‌های صفر پیشرو شود.
-   **خروجی بلوک:** بلوک کامل و معتبر را در قالب JSON خروجی دهید.

### معیارهای پذیرش

-   هش بلوک استخراج شده با دشواری مشخص شده مطابقت دارد.
-   فیلدهای موجود در JSON بلوک خروجی با مشخصات مطابقت دارند.

## نقطه عطف 6: اثبات شمول

آخرین نقطه عطف، پیاده‌سازی اثبات‌های مرکل است که امکان تأیید کارآمد شمول تراکنش را فراهم می‌کند.

### وظایف

-   **`GetMerkleProof`:** دستور `GetMerkleProof` را پیاده‌سازی کنید که باید لیستی از هش‌های همسایه و موقعیت‌های آنها را که برای اثبات شمول یک تراکنش لازم است، برگرداند.
-   **`VerifyTxInclusion`:** دستور `VerifyTxInclusion` را پیاده‌سازی کنید که باید در صورت معتبر بودن اثبات `true` و در غیر این صورت `false` را برگرداند.

### معیارهای پذیرش

-   یک اثبات مرکل معتبر به درستی در برابر ریشه مرکل در هدر بلوک تأیید می‌شود.

## نتیجه‌گیری

با تکمیل این نقاط عطف، شما یک بلاکچین تک گره‌ای کاملاً کاربردی را از ابتدا ساخته‌اید. این دستاورد مهم را به شما تبریک می‌گوییم!

---
[← بازگشت: خلاصه تکلیف](assignment.md) · [بعدی: تست‌ها و ورودی/خروجی مثال →](tests.md)